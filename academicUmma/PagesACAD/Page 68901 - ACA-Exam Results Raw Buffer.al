page 68901 "ACA-Exam Results Raw Buffer"
{
    PageType = List;
    SourceTable = "ACA-Exam Results Raw Buffer";

    layout
    {
        area(content)
        {
            repeater(Group)
            {
                field(Serial; Rec.Serial)
                {
                    ApplicationArea = All;
                }
                field("Year of Study"; Rec."Year of Study")
                {
                    ApplicationArea = All;
                }
                field("Academic Year"; Rec."Academic Year")
                {
                    ApplicationArea = All;
                }
                field("Student No."; Rec."Student No.")
                {
                    ApplicationArea = All;
                }
                field(Name; Rec.Name)
                {
                    ApplicationArea = All;
                }
                field(Prog; Rec.Prog)
                {
                    ApplicationArea = All;
                }
                field("Unit 1"; Rec."Unit 1")
                {
                    ApplicationArea = All;
                }
                field("Unit 2"; Rec."Unit 2")
                {
                    ApplicationArea = All;
                }
                field("Unit 3"; Rec."Unit 3")
                {
                    ApplicationArea = All;
                }
                field("Unit 4"; Rec."Unit 4")
                {
                    ApplicationArea = All;
                }
                field("Unit 5"; Rec."Unit 5")
                {
                    ApplicationArea = All;
                }
                field("Unit 6"; Rec."Unit 6")
                {
                    ApplicationArea = All;
                }
                field("Unit 7"; Rec."Unit 7")
                {
                    ApplicationArea = All;
                }
                field("Unit 8"; Rec."Unit 8")
                {
                    ApplicationArea = All;
                }
                field("Unit 9"; Rec."Unit 9")
                {
                    ApplicationArea = All;
                }
                field("Unit 10"; Rec."Unit 10")
                {
                    ApplicationArea = All;
                }
                field("Unit 11"; Rec."Unit 11")
                {
                    ApplicationArea = All;
                }
                field("Unit 12"; Rec."Unit 12")
                {
                    ApplicationArea = All;
                }
                field("Unit 13"; Rec."Unit 13")
                {
                    ApplicationArea = All;
                }
                field("Unit 14"; Rec."Unit 14")
                {
                    ApplicationArea = All;
                }
                field("Unit 15"; Rec."Unit 15")
                {
                    ApplicationArea = All;
                }
                field("Unit 16"; Rec."Unit 16")
                {
                    ApplicationArea = All;
                }
                field("Unit 17"; Rec."Unit 17")
                {
                    ApplicationArea = All;
                }
                field("Unit 18"; Rec."Unit 18")
                {
                    ApplicationArea = All;
                }
                field("Unit 19"; Rec."Unit 19")
                {
                    ApplicationArea = All;
                }
                field("Unit 20"; Rec."Unit 20")
                {
                    ApplicationArea = All;
                }
                field("Unit 21"; Rec."Unit 21")
                {
                    ApplicationArea = All;
                }
                field("Unit 22"; Rec."Unit 22")
                {
                    ApplicationArea = All;
                }
                field("Unit 23"; Rec."Unit 23")
                {
                    ApplicationArea = All;
                }
                field("Unit 24"; Rec."Unit 24")
                {
                    ApplicationArea = All;
                }
                field("Unit 25"; Rec."Unit 25")
                {
                    ApplicationArea = All;
                }
                field("Unit 26"; Rec."Unit 26")
                {
                    ApplicationArea = All;
                }
                field("Unit 27"; Rec."Unit 27")
                {
                    ApplicationArea = All;
                }
                field("Unit 28"; Rec."Unit 28")
                {
                    ApplicationArea = All;
                }
                field("Unit 29"; Rec."Unit 29")
                {
                    ApplicationArea = All;
                }
                field("Unit 30"; Rec."Unit 30")
                {
                    ApplicationArea = All;
                }
                field("Unit 31"; Rec."Unit 31")
                {
                    ApplicationArea = All;
                }
                field("Unit 32"; Rec."Unit 32")
                {
                    ApplicationArea = All;
                }
                field("Unit 33"; Rec."Unit 33")
                {
                    ApplicationArea = All;
                }
                field("Unit 34"; Rec."Unit 34")
                {
                    ApplicationArea = All;
                }
                field("Unit 35"; Rec."Unit 35")
                {
                    ApplicationArea = All;
                }
                field("Unit 36"; Rec."Unit 36")
                {
                    ApplicationArea = All;
                }
                field("Unit 37"; Rec."Unit 37")
                {
                    ApplicationArea = All;
                }
                field("Unit 38"; Rec."Unit 38")
                {
                    ApplicationArea = All;
                }
                field("Unit 39"; Rec."Unit 39")
                {
                    ApplicationArea = All;
                }
                field("Unit 40"; Rec."Unit 40")
                {
                    ApplicationArea = All;
                }
                field("Unit 41"; Rec."Unit 41")
                {
                    ApplicationArea = All;
                }
                field("Unit 42"; Rec."Unit 42")
                {
                    ApplicationArea = All;
                }
                field("Unit 43"; Rec."Unit 43")
                {
                    ApplicationArea = All;
                }
                field("Unit 44"; Rec."Unit 44")
                {
                    ApplicationArea = All;
                }
                field("Unit 45"; Rec."Unit 45")
                {
                    ApplicationArea = All;
                }
                field("Unit 46"; Rec."Unit 46")
                {
                    ApplicationArea = All;
                }
                field("Unit 47"; Rec."Unit 47")
                {
                    ApplicationArea = All;
                }
                field("Unit 48"; Rec."Unit 48")
                {
                    ApplicationArea = All;
                }
                field("Unit 49"; Rec."Unit 49")
                {
                    ApplicationArea = All;
                }
                field("Unit 50"; Rec."Unit 50")
                {
                    ApplicationArea = All;
                }
                field("Unit 51"; Rec."Unit 51")
                {
                    ApplicationArea = All;
                }
                field("Unit 52"; Rec."Unit 52")
                {
                    ApplicationArea = All;
                }
                field("Unit 53"; Rec."Unit 53")
                {
                    ApplicationArea = All;
                }
                field("Unit 54"; Rec."Unit 54")
                {
                    ApplicationArea = All;
                }
                field("Unit 55"; Rec."Unit 55")
                {
                    ApplicationArea = All;
                }
                field("Unit 56"; Rec."Unit 56")
                {
                    ApplicationArea = All;
                }
                field("Unit 57"; Rec."Unit 57")
                {
                    ApplicationArea = All;
                }
                field("Unit 58"; Rec."Unit 58")
                {
                    ApplicationArea = All;
                }
                field("Unit 59"; Rec."Unit 59")
                {
                    ApplicationArea = All;
                }
                field("Unit 60"; Rec."Unit 60")
                {
                    ApplicationArea = All;
                }
                field("Unit 61"; Rec."Unit 61")
                {
                    ApplicationArea = All;
                }
                field("Unit 62"; Rec."Unit 62")
                {
                    ApplicationArea = All;
                }
                field("Unit 63"; Rec."Unit 63")
                {
                    ApplicationArea = All;
                }
                field("Unit 64"; Rec."Unit 64")
                {
                    ApplicationArea = All;
                }
                field("Unit 65"; Rec."Unit 65")
                {
                    ApplicationArea = All;
                }
                field("Unit 66"; Rec."Unit 66")
                {
                    ApplicationArea = All;
                }
                field("Unit 67"; Rec."Unit 67")
                {
                    ApplicationArea = All;
                }
                field("Unit 68"; Rec."Unit 68")
                {
                    ApplicationArea = All;
                }
                field("Unit 69"; Rec."Unit 69")
                {
                    ApplicationArea = All;
                }
                field("Unit 70"; Rec."Unit 70")
                {
                    ApplicationArea = All;
                }
                field("Unit 71"; Rec."Unit 71")
                {
                    ApplicationArea = All;
                }
                field("Unit 72"; Rec."Unit 72")
                {
                    ApplicationArea = All;
                }
                field("Unit 73"; Rec."Unit 73")
                {
                    ApplicationArea = All;
                }
                field("Unit 74"; Rec."Unit 74")
                {
                    ApplicationArea = All;
                }
                field("Unit 75"; Rec."Unit 75")
                {
                    ApplicationArea = All;
                }
                field("Unit 76"; Rec."Unit 76")
                {
                    ApplicationArea = All;
                }
                field("Unit 77"; Rec."Unit 77")
                {
                    ApplicationArea = All;
                }
                field("Unit 78"; Rec."Unit 78")
                {
                    ApplicationArea = All;
                }
                field("Unit 79"; Rec."Unit 79")
                {
                    ApplicationArea = All;
                }
                field("Unit 80"; Rec."Unit 80")
                {
                    ApplicationArea = All;
                }
                field("Unit 81"; Rec."Unit 81")
                {
                    ApplicationArea = All;
                }
                field("Unit 82"; Rec."Unit 82")
                {
                    ApplicationArea = All;
                }
                field("Unit 83"; Rec."Unit 83")
                {
                    ApplicationArea = All;
                }
                field("Unit 84"; Rec."Unit 84")
                {
                    ApplicationArea = All;
                }
                field("Unit 85"; Rec."Unit 85")
                {
                    ApplicationArea = All;
                }
                field("Unit 86"; Rec."Unit 86")
                {
                    ApplicationArea = All;
                }
                field("Unit 87"; Rec."Unit 87")
                {
                    ApplicationArea = All;
                }
                field("Unit 88"; Rec."Unit 88")
                {
                    ApplicationArea = All;
                }
                field("Unit 89"; Rec."Unit 89")
                {
                    ApplicationArea = All;
                }
                field("Unit 90"; Rec."Unit 90")
                {
                    ApplicationArea = All;
                }
                field("Unit 91"; Rec."Unit 91")
                {
                    ApplicationArea = All;
                }
                field("Unit 92"; Rec."Unit 92")
                {
                    ApplicationArea = All;
                }
                field("Unit 93"; Rec."Unit 93")
                {
                    ApplicationArea = All;
                }
                field("Unit 94"; Rec."Unit 94")
                {
                    ApplicationArea = All;
                }
                field("Unit 95"; Rec."Unit 95")
                {
                    ApplicationArea = All;
                }
                field("Unit 96"; Rec."Unit 96")
                {
                    ApplicationArea = All;
                }
                field("Unit 97"; Rec."Unit 97")
                {
                    ApplicationArea = All;
                }
                field("Unit 98"; Rec."Unit 98")
                {
                    ApplicationArea = All;
                }
                field("Unit 99"; Rec."Unit 99")
                {
                    ApplicationArea = All;
                }
                field("Unit 100"; Rec."Unit 100")
                {
                    ApplicationArea = All;
                }
                field(Posted; Rec.Posted)
                {
                    Editable = false;
                    Enabled = false;
                    ApplicationArea = All;
                }
                field("User Name"; Rec."User Name")
                {
                    Editable = false;
                    Enabled = false;
                    ApplicationArea = All;
                }
            }
        }
    }

    actions
    {
        area(creation)
        {
            group(Post)
            {
                Caption = 'Import/Post';
                action(Import)
                {
                    Caption = 'Import Raw Results';
                    Image = ImportExcel;
                    Promoted = true;
                    Visible = false;
                    ApplicationArea = All;

                    trigger OnAction()
                    begin
                        IF CONFIRM('Import raw Marks', TRUE) = FALSE THEN ERROR('Cancelled by User');
                        // Run port 50802
                        /* IF CONFIRM('Import the Marks with the following columns:\'+
                           'Serial\'+
                        'Student No.\'+
                        'Name\'+
                        'Units\'+
                        'Prog\'+
                        'Intake\'+
                        'Exam Series\'+
                        'Semester\'+
                        'Academic Year\'+
                        'Stage\'+
                        'Student Type\'+
                        'Unit 1\'+
                        'Unit 2\'+
                        'Unit 3\'+
                        'Unit 4\'+
                        'Unit 5\'+
                        'Unit 6\'+
                        'Unit 7\'+
                        'Unit 8\'+
                        'Unit 9\'+
                        'Unit 10\'+
                        'Unit 11\'+
                        'Unit 12\'+
                        'Unit 13\',TRUE)= FALSE THEN ERROR('Cancelled by User');*/
                        XMLPORT.RUN(50802, FALSE, TRUE);
                        MESSAGE('Raw marks imported successfully!');

                    end;
                }
                action(Post_Res)
                {
                    Caption = 'Post Row Results';
                    Image = ExecuteAndPostBatch;
                    Promoted = true;
                    ApplicationArea = All;

                    trigger OnAction()
                    begin
                        //IF CONFIRM('This will post marks to the results buffer,\Continue?',TRUE)=FALSE THEN ERROR('You cancelled the process!');
                        CLEAR(RecCount1);
                        CLEAR(RecCount2);
                        CLEAR(RecCount3);
                        CLEAR(RecCount4);
                        CLEAR(RecCount5);
                        CLEAR(RecCount6);
                        CLEAR(RecCount7);
                        CLEAR(RecCount8);
                        CLEAR(RecCount9);
                        CLEAR(RecCount10);
                        CLEAR(counts);
                        progre.OPEN('Processing Please wait..............\#1###############################################################' +
                        '\#2###############################################################' +
                        '\#3###############################################################' +
                        '\#4###############################################################' +
                        '\#5###############################################################' +
                        '\#6###############################################################' +
                        '\#7###############################################################' +
                        '\#8###############################################################' +
                        '\#9###############################################################' +
                        '\#10###############################################################' +
                        '\#11###############################################################' +
                        '\#12###############################################################' +
                        '\#13###############################################################',
                            RecCount1,
                            RecCount2,
                            RecCount3,
                            RecCount4,
                            RecCount5,
                            RecCount6,
                            RecCount7,
                            RecCount8,
                            RecCount9,
                            RecCount10,
                            Var1,
                            Var1,
                            BufferString
                        );

                        examrawbuffer.RESET;
                        examrawbuffer.SETRANGE(Posted, FALSE);
                        examrawbuffer.SETRANGE("User Name", USERID);
                        IF examrawbuffer.FIND('-') THEN BEGIN
                            BEGIN
                                REPEAT
                                BEGIN
                                    counts := counts + 1;
                                    IF counts = 1 THEN
                                        RecCount1 := FORMAT(counts) + '). ' + examrawbuffer."Student No." + ': ' + examrawbuffer.Name
                                    ELSE
                                        IF counts = 2 THEN BEGIN
                                            RecCount2 := FORMAT(counts) + '). ' + examrawbuffer."Student No." + ': ' + examrawbuffer.Name
                                        END
                                        ELSE
                                            IF counts = 3 THEN BEGIN
                                                RecCount3 := FORMAT(counts) + '). ' + examrawbuffer."Student No." + ': ' + examrawbuffer.Name
                                            END
                                            ELSE
                                                IF counts = 4 THEN BEGIN
                                                    RecCount4 := FORMAT(counts) + '). ' + examrawbuffer."Student No." + ': ' + examrawbuffer.Name
                                                END
                                                ELSE
                                                    IF counts = 5 THEN BEGIN
                                                        RecCount5 := FORMAT(counts) + '). ' + examrawbuffer."Student No." + ': ' + examrawbuffer.Name
                                                    END
                                                    ELSE
                                                        IF counts = 6 THEN BEGIN
                                                            RecCount6 := FORMAT(counts) + '). ' + examrawbuffer."Student No." + ': ' + examrawbuffer.Name
                                                        END
                                                        ELSE
                                                            IF counts = 7 THEN BEGIN
                                                                RecCount7 := FORMAT(counts) + '). ' + examrawbuffer."Student No." + ': ' + examrawbuffer.Name
                                                            END
                                                            ELSE
                                                                IF counts = 8 THEN BEGIN
                                                                    RecCount8 := FORMAT(counts) + '). ' + examrawbuffer."Student No." + ': ' + examrawbuffer.Name
                                                                END
                                                                ELSE
                                                                    IF counts = 9 THEN BEGIN
                                                                        RecCount9 := FORMAT(counts) + '). ' + examrawbuffer."Student No." + ': ' + examrawbuffer.Name
                                                                    END
                                                                    ELSE
                                                                        IF counts = 10 THEN BEGIN
                                                                            RecCount10 := FORMAT(counts) + '). ' + examrawbuffer."Student No." + ': ' + examrawbuffer.Name
                                                                        END ELSE
                                                                            IF counts > 10 THEN BEGIN
                                                                                RecCount1 := RecCount2;
                                                                                RecCount2 := RecCount3;
                                                                                RecCount3 := RecCount4;
                                                                                RecCount4 := RecCount5;
                                                                                RecCount5 := RecCount6;
                                                                                RecCount6 := RecCount7;
                                                                                RecCount7 := RecCount8;
                                                                                RecCount8 := RecCount9;
                                                                                RecCount9 := RecCount10;
                                                                                RecCount10 := FORMAT(counts) + '). ' + examrawbuffer."Student No." + ': ' + examrawbuffer.Name;
                                                                            END;
                                    CLEAR(BufferString);
                                    BufferString := 'Total Records processed = ' + FORMAT(counts);
                                    // Update Buffer
                                    IF ((COPYSTR(examrawbuffer."Student No.", 1, 6) = 'REGIST') OR (COPYSTR(examrawbuffer."Student No.", 1, 6) = 'STUDEN')
                                      OR (COPYSTR(examrawbuffer."Student No.", 1, 3) = 'ADM') OR (COPYSTR(examrawbuffer."Student No.", 1, 2) = 'NO')
                                      OR (COPYSTR(examrawbuffer."Student No.", 1, 3) = 'REG')) THEN BEGIN
                                        // Dont insert but pick the headers
                                        CLEAR(unit_1);
                                        CLEAR(unit_2);
                                        CLEAR(unit_3);
                                        CLEAR(unit_4);
                                        CLEAR(unit_5);
                                        CLEAR(unit_6);
                                        CLEAR(unit_7);
                                        CLEAR(unit_8);
                                        CLEAR(unit_9);
                                        CLEAR(unit_10);
                                        CLEAR(unit_11);
                                        CLEAR(unit_12);
                                        CLEAR(unit_13);
                                        CLEAR(unit_14);
                                        CLEAR(unit_15);
                                        CLEAR(unit_16);
                                        CLEAR(unit_17);
                                        CLEAR(unit_18);
                                        CLEAR(unit_19);
                                        CLEAR(unit_20);
                                        CLEAR(unit_21);
                                        CLEAR(unit_22);
                                        CLEAR(unit_23);
                                        CLEAR(unit_24);
                                        CLEAR(unit_25);
                                        CLEAR(unit_26);
                                        CLEAR(unit_27);
                                        CLEAR(unit_28);
                                        CLEAR(unit_29);
                                        CLEAR(unit_30);
                                        CLEAR(unit_31);
                                        CLEAR(unit_32);
                                        CLEAR(unit_33);
                                        CLEAR(unit_34);
                                        CLEAR(unit_35);
                                        CLEAR(unit_36);
                                        CLEAR(unit_37);
                                        CLEAR(unit_38);
                                        CLEAR(unit_39);
                                        CLEAR(unit_40);
                                        CLEAR(unit_41);
                                        CLEAR(unit_42);
                                        CLEAR(unit_43);
                                        CLEAR(unit_44);
                                        CLEAR(unit_45);
                                        CLEAR(unit_46);
                                        CLEAR(unit_47);
                                        CLEAR(unit_48);
                                        CLEAR(unit_49);
                                        CLEAR(unit_50);
                                        CLEAR(unit_51);
                                        CLEAR(unit_52);
                                        CLEAR(unit_53);
                                        CLEAR(unit_54);
                                        CLEAR(unit_55);
                                        CLEAR(unit_56);
                                        CLEAR(unit_57);
                                        CLEAR(unit_58);
                                        CLEAR(unit_59);
                                        CLEAR(unit_60);
                                        CLEAR(unit_61);
                                        CLEAR(unit_62);
                                        CLEAR(unit_63);
                                        CLEAR(unit_64);
                                        CLEAR(unit_65);
                                        CLEAR(unit_66);
                                        CLEAR(unit_67);
                                        CLEAR(unit_68);
                                        CLEAR(unit_69);
                                        CLEAR(unit_70);
                                        CLEAR(unit_71);
                                        CLEAR(unit_72);
                                        CLEAR(unit_73);
                                        CLEAR(unit_74);
                                        CLEAR(unit_75);
                                        CLEAR(unit_76);
                                        CLEAR(unit_77);
                                        CLEAR(unit_78);
                                        CLEAR(unit_79);
                                        CLEAR(unit_80);
                                        CLEAR(unit_81);
                                        CLEAR(unit_82);
                                        CLEAR(unit_83);
                                        CLEAR(unit_84);
                                        CLEAR(unit_85);
                                        CLEAR(unit_86);
                                        CLEAR(unit_87);
                                        CLEAR(unit_88);
                                        CLEAR(unit_89);
                                        CLEAR(unit_90);
                                        CLEAR(unit_91);
                                        CLEAR(unit_92);
                                        CLEAR(unit_93);
                                        CLEAR(unit_94);
                                        CLEAR(unit_95);
                                        CLEAR(unit_96);
                                        CLEAR(unit_97);
                                        CLEAR(unit_98);
                                        CLEAR(unit_99);
                                        CLEAR(unit_100);

                                        unit_1 := examrawbuffer."Unit 1";
                                        unit_2 := examrawbuffer."Unit 2";
                                        unit_3 := examrawbuffer."Unit 3";
                                        unit_4 := examrawbuffer."Unit 4";
                                        unit_5 := examrawbuffer."Unit 5";
                                        unit_6 := examrawbuffer."Unit 6";
                                        unit_7 := examrawbuffer."Unit 7";
                                        unit_8 := examrawbuffer."Unit 8";
                                        unit_9 := examrawbuffer."Unit 9";

                                        unit_10 := examrawbuffer."Unit 10";
                                        unit_11 := examrawbuffer."Unit 11";
                                        unit_12 := examrawbuffer."Unit 12";
                                        unit_13 := examrawbuffer."Unit 13";
                                        unit_14 := examrawbuffer."Unit 14";
                                        unit_15 := examrawbuffer."Unit 15";
                                        unit_16 := examrawbuffer."Unit 16";
                                        unit_17 := examrawbuffer."Unit 17";
                                        unit_18 := examrawbuffer."Unit 18";
                                        unit_19 := examrawbuffer."Unit 19";

                                        unit_20 := examrawbuffer."Unit 20";
                                        unit_21 := examrawbuffer."Unit 21";
                                        unit_22 := examrawbuffer."Unit 22";
                                        unit_23 := examrawbuffer."Unit 23";
                                        unit_24 := examrawbuffer."Unit 24";
                                        unit_25 := examrawbuffer."Unit 25";
                                        unit_26 := examrawbuffer."Unit 26";
                                        unit_27 := examrawbuffer."Unit 27";
                                        unit_28 := examrawbuffer."Unit 28";
                                        unit_29 := examrawbuffer."Unit 29";
                                        unit_30 := examrawbuffer."Unit 30";
                                        unit_31 := examrawbuffer."Unit 31";
                                        unit_32 := examrawbuffer."Unit 32";
                                        unit_33 := examrawbuffer."Unit 33";
                                        unit_34 := examrawbuffer."Unit 34";
                                        unit_35 := examrawbuffer."Unit 35";
                                        unit_36 := examrawbuffer."Unit 36";
                                        unit_37 := examrawbuffer."Unit 37";
                                        unit_38 := examrawbuffer."Unit 38";
                                        unit_39 := examrawbuffer."Unit 39";
                                        unit_40 := examrawbuffer."Unit 40";
                                        unit_41 := examrawbuffer."Unit 41";
                                        unit_42 := examrawbuffer."Unit 42";
                                        unit_43 := examrawbuffer."Unit 43";
                                        unit_44 := examrawbuffer."Unit 44";
                                        unit_45 := examrawbuffer."Unit 45";
                                        unit_46 := examrawbuffer."Unit 46";
                                        unit_47 := examrawbuffer."Unit 47";
                                        unit_48 := examrawbuffer."Unit 48";
                                        unit_49 := examrawbuffer."Unit 49";
                                        unit_50 := examrawbuffer."Unit 50";
                                        unit_51 := examrawbuffer."Unit 51";
                                        unit_52 := examrawbuffer."Unit 52";
                                        unit_53 := examrawbuffer."Unit 53";
                                        unit_54 := examrawbuffer."Unit 54";
                                        unit_55 := examrawbuffer."Unit 55";
                                        unit_56 := examrawbuffer."Unit 56";
                                        unit_57 := examrawbuffer."Unit 57";
                                        unit_58 := examrawbuffer."Unit 58";
                                        unit_59 := examrawbuffer."Unit 59";
                                        unit_60 := examrawbuffer."Unit 60";
                                        unit_61 := examrawbuffer."Unit 61";
                                        unit_62 := examrawbuffer."Unit 62";
                                        unit_63 := examrawbuffer."Unit 63";
                                        unit_64 := examrawbuffer."Unit 64";
                                        unit_65 := examrawbuffer."Unit 65";
                                        unit_66 := examrawbuffer."Unit 66";
                                        unit_67 := examrawbuffer."Unit 67";
                                        unit_68 := examrawbuffer."Unit 68";
                                        unit_69 := examrawbuffer."Unit 69";
                                        unit_70 := examrawbuffer."Unit 70";
                                        unit_71 := examrawbuffer."Unit 71";
                                        unit_72 := examrawbuffer."Unit 72";
                                        unit_73 := examrawbuffer."Unit 73";
                                        unit_74 := examrawbuffer."Unit 74";
                                        unit_75 := examrawbuffer."Unit 75";
                                        unit_76 := examrawbuffer."Unit 76";
                                        unit_77 := examrawbuffer."Unit 77";
                                        unit_78 := examrawbuffer."Unit 78";
                                        unit_79 := examrawbuffer."Unit 79";
                                        unit_80 := examrawbuffer."Unit 80";
                                        unit_81 := examrawbuffer."Unit 81";
                                        unit_82 := examrawbuffer."Unit 82";
                                        unit_83 := examrawbuffer."Unit 83";
                                        unit_84 := examrawbuffer."Unit 84";
                                        unit_85 := examrawbuffer."Unit 85";
                                        unit_86 := examrawbuffer."Unit 86";
                                        unit_87 := examrawbuffer."Unit 87";
                                        unit_88 := examrawbuffer."Unit 88";
                                        unit_89 := examrawbuffer."Unit 89";
                                        unit_90 := examrawbuffer."Unit 90";
                                        unit_91 := examrawbuffer."Unit 91";
                                        unit_92 := examrawbuffer."Unit 92";
                                        unit_93 := examrawbuffer."Unit 93";
                                        unit_94 := examrawbuffer."Unit 94";
                                        unit_95 := examrawbuffer."Unit 95";
                                        unit_96 := examrawbuffer."Unit 96";
                                        unit_97 := examrawbuffer."Unit 97";
                                        unit_98 := examrawbuffer."Unit 98";
                                        unit_99 := examrawbuffer."Unit 99";
                                        unit_100 := examrawbuffer."Unit 100";



                                    END ELSE BEGIN
                                        // Insert Based on the headers Selected
                                        // Unit 100
                                        CallInsertion(examrawbuffer."Unit 100", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_100, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 99
                                        CallInsertion(examrawbuffer."Unit 99", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_99, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 98
                                        CallInsertion(examrawbuffer."Unit 98", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_98, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 97
                                        CallInsertion(examrawbuffer."Unit 97", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_97, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 96
                                        CallInsertion(examrawbuffer."Unit 96", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_96, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 95
                                        CallInsertion(examrawbuffer."Unit 95", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_95, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 94
                                        CallInsertion(examrawbuffer."Unit 94", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_94, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 93
                                        CallInsertion(examrawbuffer."Unit 93", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_93, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 92
                                        CallInsertion(examrawbuffer."Unit 92", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_92, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 91
                                        CallInsertion(examrawbuffer."Unit 91", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_91, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 90
                                        CallInsertion(examrawbuffer."Unit 90", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_90, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 89
                                        CallInsertion(examrawbuffer."Unit 89", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_89, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 88
                                        CallInsertion(examrawbuffer."Unit 88", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_88, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 87
                                        CallInsertion(examrawbuffer."Unit 87", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_87, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 86
                                        CallInsertion(examrawbuffer."Unit 86", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_86, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 85
                                        CallInsertion(examrawbuffer."Unit 85", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_85, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 84
                                        CallInsertion(examrawbuffer."Unit 84", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_84, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 83
                                        CallInsertion(examrawbuffer."Unit 83", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_83, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 82
                                        CallInsertion(examrawbuffer."Unit 82", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_82, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 81
                                        CallInsertion(examrawbuffer."Unit 81", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_81, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 80
                                        CallInsertion(examrawbuffer."Unit 80", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_80, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 79
                                        CallInsertion(examrawbuffer."Unit 79", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_79, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 78
                                        CallInsertion(examrawbuffer."Unit 78", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_78, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 77
                                        CallInsertion(examrawbuffer."Unit 77", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_77, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 76
                                        CallInsertion(examrawbuffer."Unit 76", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_76, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 75
                                        CallInsertion(examrawbuffer."Unit 75", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_75, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 74
                                        CallInsertion(examrawbuffer."Unit 74", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_74, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 73
                                        CallInsertion(examrawbuffer."Unit 73", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_73, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 72
                                        CallInsertion(examrawbuffer."Unit 72", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_72, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 71
                                        CallInsertion(examrawbuffer."Unit 71", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_71, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 70
                                        CallInsertion(examrawbuffer."Unit 70", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_70, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 69
                                        CallInsertion(examrawbuffer."Unit 69", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_69, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 68
                                        CallInsertion(examrawbuffer."Unit 68", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_68, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 67
                                        CallInsertion(examrawbuffer."Unit 67", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_67, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 66
                                        CallInsertion(examrawbuffer."Unit 66", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_66, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 65
                                        CallInsertion(examrawbuffer."Unit 65", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_65, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 64
                                        CallInsertion(examrawbuffer."Unit 64", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_64, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 63
                                        CallInsertion(examrawbuffer."Unit 63", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_63, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 62
                                        CallInsertion(examrawbuffer."Unit 62", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_62, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 61
                                        CallInsertion(examrawbuffer."Unit 61", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_61, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 60
                                        CallInsertion(examrawbuffer."Unit 60", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_60, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 59
                                        CallInsertion(examrawbuffer."Unit 59", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_59, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 58
                                        CallInsertion(examrawbuffer."Unit 58", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_58, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 57
                                        CallInsertion(examrawbuffer."Unit 57", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_57, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 56
                                        CallInsertion(examrawbuffer."Unit 56", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_56, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 55
                                        CallInsertion(examrawbuffer."Unit 55", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_55, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 54
                                        CallInsertion(examrawbuffer."Unit 54", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_54, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 53
                                        CallInsertion(examrawbuffer."Unit 53", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_53, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 52
                                        CallInsertion(examrawbuffer."Unit 52", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_52, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 51
                                        CallInsertion(examrawbuffer."Unit 51", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_51, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 50
                                        CallInsertion(examrawbuffer."Unit 50", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_50, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 49
                                        CallInsertion(examrawbuffer."Unit 49", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_49, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 48
                                        CallInsertion(examrawbuffer."Unit 48", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_48, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 47
                                        CallInsertion(examrawbuffer."Unit 47", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_47, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 46
                                        CallInsertion(examrawbuffer."Unit 46", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_46, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 45
                                        CallInsertion(examrawbuffer."Unit 45", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_45, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 44
                                        CallInsertion(examrawbuffer."Unit 44", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_44, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 43
                                        CallInsertion(examrawbuffer."Unit 43", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_43, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 42
                                        CallInsertion(examrawbuffer."Unit 42", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_42, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 41
                                        CallInsertion(examrawbuffer."Unit 41", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_41, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 40
                                        CallInsertion(examrawbuffer."Unit 40", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_40, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 39
                                        CallInsertion(examrawbuffer."Unit 39", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_39, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 38
                                        CallInsertion(examrawbuffer."Unit 38", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_38, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 37
                                        CallInsertion(examrawbuffer."Unit 37", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_37, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 36
                                        CallInsertion(examrawbuffer."Unit 36", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_36, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 35
                                        CallInsertion(examrawbuffer."Unit 35", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_35, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 34
                                        CallInsertion(examrawbuffer."Unit 34", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_34, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 33
                                        CallInsertion(examrawbuffer."Unit 33", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_33, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 32
                                        CallInsertion(examrawbuffer."Unit 32", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_32, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 31
                                        CallInsertion(examrawbuffer."Unit 31", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_31, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 30
                                        CallInsertion(examrawbuffer."Unit 30", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_30, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 29
                                        CallInsertion(examrawbuffer."Unit 29", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_29, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 28
                                        CallInsertion(examrawbuffer."Unit 28", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_28, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 27
                                        CallInsertion(examrawbuffer."Unit 27", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_27, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 26
                                        CallInsertion(examrawbuffer."Unit 26", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_26, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 25
                                        CallInsertion(examrawbuffer."Unit 25", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_25, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 24
                                        CallInsertion(examrawbuffer."Unit 24", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_24, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 23
                                        CallInsertion(examrawbuffer."Unit 23", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_23, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 22
                                        CallInsertion(examrawbuffer."Unit 22", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_22, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 21
                                        CallInsertion(examrawbuffer."Unit 21", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_21, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 20
                                        CallInsertion(examrawbuffer."Unit 20", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_20, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 19
                                        CallInsertion(examrawbuffer."Unit 19", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_19, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 18
                                        CallInsertion(examrawbuffer."Unit 18", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_18, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 17
                                        CallInsertion(examrawbuffer."Unit 17", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_17, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 16
                                        CallInsertion(examrawbuffer."Unit 16", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_16, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 15
                                        CallInsertion(examrawbuffer."Unit 15", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_15, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 14
                                        CallInsertion(examrawbuffer."Unit 14", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_14, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 13
                                        CallInsertion(examrawbuffer."Unit 13", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_13, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 12
                                        CallInsertion(examrawbuffer."Unit 12", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_12, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 11
                                        CallInsertion(examrawbuffer."Unit 11", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_11, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 10
                                        CallInsertion(examrawbuffer."Unit 10", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_10, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 9
                                        CallInsertion(examrawbuffer."Unit 9", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_9, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 8
                                        CallInsertion(examrawbuffer."Unit 8", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_8, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 7
                                        CallInsertion(examrawbuffer."Unit 7", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_7, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 6
                                        CallInsertion(examrawbuffer."Unit 6", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_6, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 5
                                        CallInsertion(examrawbuffer."Unit 5", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_5, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 4
                                        CallInsertion(examrawbuffer."Unit 4", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_4, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 3
                                        CallInsertion(examrawbuffer."Unit 3", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_3, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 2
                                        CallInsertion(examrawbuffer."Unit 2", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_2, examrawbuffer.Prog, examrawbuffer.Name);
                                        //Unit 1
                                        CallInsertion(examrawbuffer."Unit 1", examrawbuffer."Student No.",
                                        examrawbuffer."Academic Year", examrawbuffer."Year of Study", unit_1, examrawbuffer.Prog, examrawbuffer.Name);

                                    END;


                                    examrawbuffer.Posted := TRUE;
                                    examrawbuffer.MODIFY;
                                    progre.UPDATE();
                                    //  SLEEP(50);

                                END;
                                UNTIL examrawbuffer.NEXT = 0;
                            END;
                        END;

                        progre.CLOSE;
                        PAGE.RUN(77717);

                        CurrPage.UPDATE;
                        //MESSAGE('Records Processed succeesfully.');
                        //MESSAGE(FORMAT(counts)+' Records Processed');
                    end;
                }
                action(reset)
                {
                    Caption = 'reset';
                    ApplicationArea = All;

                    trigger OnAction()
                    var
                        ACAExamResultsBuffer2: Record 61746;
                    begin
                        /*examrawbuffer.RESET;
                        examrawbuffer.SETRANGE(Posted,TRUE);
                        //examrawbuffer.SETRANGE("User Name",USERID);
                        IF examrawbuffer.FIND('-') THEN BEGIN
                            REPEAT
                              BEGIN
                              examrawbuffer.Posted:=FALSE;
                              examrawbuffer.MODIFY;
                              END;
                                UNTIL examrawbuffer.NEXT=0;
                                END;
                        
                        ACAExamResultsBuffer2.RESET;
                        IF ACAExamResultsBuffer2.FIND('-') THEN ACAExamResultsBuffer2.DELETEALL;
                        */

                    end;
                }
            }
        }
    }

    trigger OnAfterGetRecord()
    begin
        Rec.SETFILTER("User Name", USERID);
    end;

    trigger OnOpenPage()
    begin
        Rec.SETFILTER("User Name", USERID);
    end;

    var
        ACACourseRegistration: Record 61532;
        ACAUnitsSubjects: Record 61517;
        ACAStudentUnits: Record 61549;
        ACAExamResults: Record 61548;
        examrawbuffer: Record 61744;
        resBuffer2: Record 61746;
        unit_1: Code[10];
        unit_2: Code[10];
        unit_3: Code[10];
        unit_4: Code[10];
        unit_5: Code[10];
        unit_6: Code[10];
        unit_7: Code[10];
        unit_8: Code[10];
        unit_9: Code[10];
        unit_10: Code[10];
        unit_11: Code[10];
        unit_12: Code[10];
        unit_13: Code[10];
        unit_14: Code[10];
        unit_15: Code[10];
        unit_16: Code[10];
        unit_17: Code[10];
        unit_18: Code[10];
        unit_19: Code[10];
        unit_20: Code[10];
        unit_21: Code[10];
        unit_22: Code[10];
        unit_23: Code[10];
        unit_24: Code[10];
        unit_25: Code[10];
        unit_26: Code[10];
        unit_27: Code[10];
        unit_28: Code[10];
        unit_29: Code[10];
        unit_30: Code[10];
        unit_31: Code[10];
        unit_32: Code[10];
        unit_33: Code[10];
        unit_34: Code[10];
        unit_35: Code[10];
        unit_36: Code[10];
        unit_37: Code[10];
        unit_38: Code[10];
        unit_39: Code[10];
        unit_40: Code[10];
        unit_41: Code[10];
        unit_42: Code[10];
        unit_43: Code[10];
        unit_44: Code[10];
        unit_45: Code[10];
        unit_46: Code[10];
        unit_47: Code[10];
        unit_48: Code[10];
        unit_49: Code[10];
        unit_50: Code[10];
        unit_51: Code[10];
        unit_52: Code[10];
        unit_53: Code[10];
        unit_54: Code[10];
        unit_55: Code[10];
        unit_56: Code[10];
        unit_57: Code[10];
        unit_58: Code[10];
        unit_59: Code[10];
        unit_60: Code[10];
        unit_61: Code[10];
        unit_62: Code[10];
        unit_63: Code[10];
        unit_64: Code[10];
        unit_65: Code[10];
        unit_66: Code[10];
        unit_67: Code[10];
        unit_68: Code[10];
        unit_69: Code[10];
        unit_70: Code[10];
        unit_71: Code[10];
        unit_72: Code[10];
        unit_73: Code[10];
        unit_74: Code[10];
        unit_75: Code[10];
        unit_76: Code[10];
        unit_77: Code[10];
        unit_78: Code[10];
        unit_79: Code[10];
        unit_80: Code[10];
        unit_81: Code[10];
        unit_82: Code[10];
        unit_83: Code[10];
        unit_84: Code[10];
        unit_85: Code[10];
        unit_86: Code[10];
        unit_87: Code[10];
        unit_88: Code[10];
        unit_89: Code[10];
        unit_90: Code[10];
        unit_91: Code[10];
        unit_92: Code[10];
        unit_93: Code[10];
        unit_94: Code[10];
        unit_95: Code[10];
        unit_96: Code[10];
        unit_97: Code[10];
        unit_98: Code[10];
        unit_99: Code[10];
        unit_100: Code[10];
        counts: Integer;
        RecCount1: Text[120];
        RecCount2: Text[120];
        RecCount3: Text[120];
        RecCount4: Text[120];
        RecCount5: Text[120];
        RecCount6: Text[120];
        RecCount7: Text[120];
        RecCount8: Text[120];
        RecCount9: Text[120];
        RecCount10: Text[120];
        BufferString: Text[1024];
        Var1: Code[10];
        progre: Dialog;
        scorsz: Decimal;

    procedure CorrectRegNos()
    var
        cust1: Record 18;
        custBuff: Record 61744;
        replace: Text[100];
        replacewith: Text[100];
        No_Stem: Text[100];
        New_No: Text[100];
        removedString: Text[100];
        counted: Integer;
        NewStem: Text[100];
        stringChar: Code[1];
    begin
        // STEP 1: Remove the first stroke
        IF CONFIRM('Update Records?', TRUE) = FALSE THEN ERROR('Cancelled by user!');

        custBuff.RESET;
        custBuff.SETFILTER(custBuff."Student No.", '<>%1', '');
        IF custBuff.FIND('-') THEN BEGIN
            REPEAT
                IF NOT (COPYSTR(custBuff."Student No.", 1, 6) = 'REGIST') THEN BEGIN
                    // Clear Variables Here
                    IF STRLEN(custBuff."Student No.") > 5 THEN BEGIN
                        CLEAR(No_Stem);
                        CLEAR(removedString);
                        IF NOT cust1.GET(custBuff."Student No.") THEN BEGIN
                            IF (COPYSTR(custBuff."Student No.", (STRLEN(custBuff."Student No.") - 2), 1)) = '/' THEN BEGIN
                                //
                                No_Stem := COPYSTR(custBuff."Student No.", 1, (STRLEN(custBuff."Student No.") - 3));
                                removedString := COPYSTR(custBuff."Student No.", (STRLEN(custBuff."Student No.") - 2), 3);
                            END// if /13
                            ELSE
                                IF (COPYSTR(custBuff."Student No.", (STRLEN(custBuff."Student No.") - 4), 1)) = '/' THEN BEGIN
                                    //
                                    No_Stem := COPYSTR(custBuff."Student No.", 1, (STRLEN(custBuff."Student No.") - 5));
                                    removedString := COPYSTR(custBuff."Student No.", (STRLEN(custBuff."Student No.") - 4), 5);
                                END;// if /2013
                            IF No_Stem <> '' THEN BEGIN
                                // create a new stem
                                CLEAR(counted);
                                CLEAR(NewStem);
                                REPEAT
                                BEGIN
                                    CLEAR(stringChar);
                                    counted := counted + 1;
                                    stringChar := COPYSTR(No_Stem, counted, 1);
                                    IF ((stringChar = '/') OR (stringChar = '\')) THEN
                                        stringChar := '-';
                                    NewStem := NewStem + stringChar;
                                END;
                                UNTIL ((counted = STRLEN(No_Stem)) OR (counted > STRLEN(No_Stem)));
                            END; // if No_Stem<>''
                                 // Modify the student No now
                            IF NewStem <> '' THEN BEGIN
                                No_Stem := NewStem;
                                No_Stem := No_Stem + removedString;
                                custBuff."Student No." := No_Stem;
                                custBuff.MODIFY;
                                //custBuff.RENAME(custBuff.Programme,No_Stem,custBuff."Academic Year",custBuff.Semester,custBuff."Reg. Trans. No.");
                            END;// if NewStem<>''
                        END;// if not in the student list
                    END;// for repeat
                END;
            UNTIL custBuff.NEXT = 0;
        END;


        // STEP 2: Check & Modify Year from eg. /13 to 2013 and back to /13 for legnth >21
        //progre.OPEN('progress......\#1####################################################################################');
        custBuff.RESET;
        custBuff.SETFILTER(custBuff."Student No.", '<>%1', '');
        IF custBuff.FIND('-') THEN BEGIN
            REPEAT
                IF NOT (COPYSTR(custBuff."Student No.", 1, 6) = 'REGIST') THEN BEGIN
                    // Clear Variables Here
                    CLEAR(No_Stem);
                    CLEAR(replace);
                    CLEAR(replacewith);
                    CLEAR(New_No);
                    IF NOT cust1.GET(custBuff."Student No.") THEN BEGIN
                        // ERROR((COPYSTR(custBuff."Student No.",((STRLEN(custBuff."Student No."))-2),1)));
                        IF (COPYSTR(custBuff."Student No.", ((STRLEN(custBuff."Student No.")) - 2), 1)) = '/' THEN BEGIN
                            IF (((STRLEN(custBuff."Student No.")) < 19) AND ((STRLEN(custBuff."Student No.")) > 5)) THEN BEGIN
                                // Change Year part format
                                replace := COPYSTR(custBuff."Student No.", (STRLEN(custBuff."Student No.") - 2), 3);
                                replacewith := '/20' + COPYSTR(custBuff."Student No.", (STRLEN(custBuff."Student No.") - 1), 2);
                                No_Stem := COPYSTR(custBuff."Student No.", 1, (STRLEN(custBuff."Student No.") - 3));
                                New_No := No_Stem + replacewith;
                                //progre.UPDATE(1,custBuff."Student No."+','+replace+','+replacewith+','+No_Stem+','+New_No);
                                //  ERROR(custBuff."Student No."+',"+replace+','+replacewith+','+No_Stem+','+New_No);
                                custBuff."Student No." := New_No;
                                custBuff.MODIFY;
                                // custBuff.RENAME(custBuff.Programme,New_No,custBuff."Academic Year",custBuff.Semester,custBuff."Reg. Trans. No.");
                            END; //STRLEN(custBuff."Student No.")<19
                        END;// if /13
                    END;// Not in the customer List
                END;// Repeat in CustBuff
            UNTIL custBuff.NEXT = 0;
        END;// custBuff.find('-')
            //progre.CLOSE;
        MESSAGE('Data edited Successfully.');
    end;

    local procedure GetSemester(YearOfStudy: Integer; StudNo: Code[20]; UnitCode: Code[20]; Prog: Code[20]) Semz: Code[20]
    begin
        ACAUnitsSubjects.RESET;
        ACAUnitsSubjects.SETRANGE(Code, UnitCode);
        ACAUnitsSubjects.SETRANGE("Programme Code", Prog);
        IF ACAUnitsSubjects.FIND('-') THEN BEGIN
            ACACourseRegistration.RESET;
            ACACourseRegistration.SETRANGE("Student No.", StudNo);
            ACACourseRegistration.SETRANGE(Stage, ACAUnitsSubjects."Stage Code");
            ACACourseRegistration.SETRANGE(Programmes, Prog);
            ACACourseRegistration.SETRANGE("Year Of Study", YearOfStudy);
            ACACourseRegistration.SETFILTER(Reversed, '=%1', FALSE);
            IF ACACourseRegistration.FIND('-') THEN BEGIN
                IF ACACourseRegistration.Semester <> '' THEN Semz := ACACourseRegistration.Semester;
            END ELSE BEGIN
                ACACourseRegistration.RESET;
                ACACourseRegistration.SETRANGE("Student No.", StudNo);
                ACACourseRegistration.SETRANGE(Programmes, Prog);
                ACACourseRegistration.SETRANGE("Year Of Study", YearOfStudy);
                ACACourseRegistration.SETFILTER(Reversed, '=%1', FALSE);
                IF ACACourseRegistration.FIND('+') THEN BEGIN
                    IF ACACourseRegistration.Semester <> '' THEN Semz := ACACourseRegistration.Semester;
                END;
            END;

        END;
    end;

    local procedure GetUnitStage(UnitCode: Code[20]; Prog: Code[20]) StageCode: Code[20]
    begin
        ACAUnitsSubjects.RESET;
        ACAUnitsSubjects.SETRANGE(Code, UnitCode);
        ACAUnitsSubjects.SETRANGE("Programme Code", Prog);
        IF ACAUnitsSubjects.FIND('-') THEN BEGIN
            StageCode := ACAUnitsSubjects."Stage Code";
        END;
    end;

    local procedure GetUnitName(UnitCode: Code[20]; Prog: Code[20]) UntName: Code[150]
    begin
        ACAUnitsSubjects.RESET;
        ACAUnitsSubjects.SETRANGE(Code, UnitCode);
        ACAUnitsSubjects.SETRANGE("Programme Code", Prog);
        IF ACAUnitsSubjects.FIND('-') THEN BEGIN
            UntName := ACAUnitsSubjects.Desription;
        END;
    end;

    local procedure CallInsertion(UnitScore: Code[20]; StudNo: Code[20]; AcadYear: Code[20]; YoS: Integer; UnitCodes: Code[20]; Prog_Code: Code[20]; StdName: Text[200])
    begin
        CLEAR(scorsz);
        IF EVALUATE(scorsz, UnitScore) THEN BEGIN
            IF scorsz > 0 THEN BEGIN
                resBuffer2.RESET;
                resBuffer2.SETRANGE(resBuffer2."Student No.", StudNo);
                resBuffer2.SETRANGE(resBuffer2."Academic Year", AcadYear);
                resBuffer2.SETRANGE(resBuffer2.Semester, (GetSemester(YoS, StudNo, UnitCodes, Prog_Code)));
                resBuffer2.SETRANGE(resBuffer2."Unit Code", UnitCodes);
                resBuffer2.SETRANGE(resBuffer2.Programme, Prog_Code);
                IF NOT (resBuffer2.FIND('-')) THEN BEGIN

                    resBuffer2.INIT;
                    resBuffer2."Student No." := StudNo;
                    resBuffer2."Academic Year" := AcadYear;
                    resBuffer2.Semester := GetSemester(YoS, StudNo, UnitCodes, Prog_Code);
                    resBuffer2.Programme := Prog_Code;
                    resBuffer2."Unit Code" := UnitCodes;
                    resBuffer2.Stage := GetUnitStage(UnitCodes, Prog_Code);
                    resBuffer2."Unit Name" := GetUnitName(UnitCodes, Prog_Code);
                    resBuffer2."Student Name" := StdName;
                    resBuffer2."User Name" := USERID;
                    resBuffer2.Exam := 'EXAM';
                    IF EVALUATE(scorsz, UnitScore) THEN
                        resBuffer2."Exam Score" := scorsz ELSE
                        IF UPPERCASE(UnitScore) = 'PASS' THEN resBuffer2."Exam Score" := 50;
                    resBuffer2."CAT Score" := 0;
                    resBuffer2.INSERT;
                END;
            END;
        END;
    end;
}

